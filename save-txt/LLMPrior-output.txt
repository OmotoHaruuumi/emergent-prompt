args:Namespace(text_enc_freeze=True, image_enc_freeze=True, use_simsiam=False, use_recon_loss=True, use_proj=False, clip_vision_adapter_late=0.2, kld_loss_beta=0.0005, word_length=15, dictionary_size=50257, latent_dim=768, hidden_dim=2048, epochs=20, batch_size=4, dataset_size=10000, save_every=1, learning_rate=1e-05, gpt_path='/root/emergent-prompt/train-model/pretrained-model/trained_gpt.pt', clip_to_gpt_path='/root/emergent-prompt/train-model/pretrained-model/trained_mlp.pt', translator_path='/root/emergent-prompt/train-model/pretrained-model/trained_translator_linear9.pt', device='cuda', debug=False, prefix='trained-model', out_dir='/root/emergent-prompt/save-output/LLMPrior', out_txt='/root/emergent-prompt/save-txt', setting_name='LLMPrior', run_path='experiments/2025-04-11T07:54:16.04111270f4f5ij/')
[{'params': <generator object Module.parameters at 0x7f036dfe13f0>, 'lr': 1e-05}]
dataset length is 10000
epoch0start
Two men in a green yard playing with a frisbee.  
Two people are walking through a garden together.      
Two men in a garden with a frisbee.    
A crane is lifting a person up into the air.    
pair image latent
0.8959511518478394
same image and text latent
0.253468781709671
pair text latent
0.660081684589386
unpair image latent
0.5413997173309326
different image and text latent
0.14986775815486908
unpair text latent
0.3701286315917969
eval_start
recon
-0.24015939712524415
simsiam
-0.23574363582581281
message entropy
4.598785892740885
image_collapse
0.3529878821477972
text_collapse
0.33804723926214986
 Avg Loss: -0.1934, SimSiam Loss: 0.0000, KLD Loss: 80.2639, Recon Loss: -0.2335
model saved
epoch1start
A man standing in a          
A man walking            
A man standing in a          
A crane working on a crane         
pair image latent
0.8959511518478394
same image and text latent
0.1581178605556488
pair text latent
0.8674139380455017
unpair image latent
0.5413997173309326
different image and text latent
0.09573923796415329
unpair text latent
0.5794719457626343
eval_start
recon
-0.24325326254963875
simsiam
-0.23753241215646267
message entropy
4.59864211730957
image_collapse
0.3560924118778672
text_collapse
0.3278129711522727
 Avg Loss: -0.2086, SimSiam Loss: 0.0000, KLD Loss: 60.3015, Recon Loss: -0.2387
model saved
epoch2start
A young man standing in a green        
A man in a  a         
A man standing in a          
A crane working in a crane working in a      
pair image latent
0.8959511518478394
same image and text latent
0.18133912980556488
pair text latent
0.9297194480895996
unpair image latent
0.5413997173309326
different image and text latent
0.08980199694633484
unpair text latent
0.3720270097255707
eval_start
recon
-0.24398726338148116
simsiam
-0.2379425897449255
message entropy
4.598570929972331
image_collapse
0.35502787042461026
text_collapse
0.3307649663338108
 Avg Loss: -0.2120, SimSiam Loss: 0.0000, KLD Loss: 59.2564, Recon Loss: -0.2417
model saved
epoch3start
A young man standing in a green        
A man walking in a a a a       
A man standing in a  a        
A crane working in a work lift        
pair image latent
0.8959511518478394
same image and text latent
0.18133912980556488
pair text latent
0.8784332275390625
unpair image latent
0.5413997173309326
different image and text latent
0.06711320579051971
unpair text latent
0.3368188738822937
eval_start
recon
-0.23878244202584029
simsiam
-0.2357692233324051
message entropy
4.598446892293294
image_collapse
0.35708664806713086
text_collapse
0.3474040852887966
 Avg Loss: -0.2115, SimSiam Loss: 0.0000, KLD Loss: 58.3221, Recon Loss: -0.2407
model saved
epoch4start
A young men standing in a green        
A man walking a a a a a       
A couple standing in a a a a       
A crane working on a lift in a       
pair image latent
0.8959511518478394
same image and text latent
0.2020317018032074
pair text latent
0.733660876750946
unpair image latent
0.5413997173309326
different image and text latent
0.07093457132577896
unpair text latent
0.34320735931396484
eval_start
recon
-0.23973042146861553
simsiam
-0.23669353222846984
message entropy
4.598304741414388
image_collapse
0.35541336213643315
text_collapse
0.34880714503960775
 Avg Loss: -0.2116, SimSiam Loss: 0.0000, KLD Loss: 57.8880, Recon Loss: -0.2406
model saved
epoch5start
A young men standing in a green        
A man walking in a a a a       
A young men standing in a a a       
A crane working on a lift in a       
pair image latent
0.8959511518478394
same image and text latent
0.2020317018032074
pair text latent
0.7872613668441772
unpair image latent
0.5413997173309326
different image and text latent
0.07093457132577896
unpair text latent
0.34320735931396484
eval_start
recon
-0.24248588575422764
simsiam
-0.2391774744093418
message entropy
4.598399342854818
image_collapse
0.3574204690232581
text_collapse
0.3372102865819817
 Avg Loss: -0.2136, SimSiam Loss: 0.0000, KLD Loss: 58.1826, Recon Loss: -0.2427
model saved
epoch6start
A young men standing in a green grass       
A man walking in a a a a       
A young men standing in a a a       
A crane working on a lift lifting a a      
pair image latent
0.8959511518478394
same image and text latent
0.21849919855594635
pair text latent
0.7872613668441772
unpair image latent
0.5413997173309326
different image and text latent
0.0784359723329544
unpair text latent
0.23802101612091064
eval_start
recon
-0.2390925730764866
simsiam
-0.23575860176980495
message entropy
4.598192714436849
image_collapse
0.35561529619865206
text_collapse
0.3519312384224337
 Avg Loss: -0.2125, SimSiam Loss: 0.0000, KLD Loss: 58.1421, Recon Loss: -0.2416
model saved
epoch7start
A young men standing in a a a a      
A young men walking in a a a a      
A young men standing in a a a       
A workers working on a crane lifting a a      
pair image latent
0.8959511518478394
same image and text latent
0.1917761266231537
pair text latent
0.8575851917266846
unpair image latent
0.5413997173309326
different image and text latent
0.11574135720729828
unpair text latent
0.5072281956672668
eval_start
recon
-0.23692487651109695
simsiam
-0.23402344699203967
message entropy
4.59809855855306
image_collapse
0.3575550401122676
text_collapse
0.3647720148328595
 Avg Loss: -0.2115, SimSiam Loss: 0.0000, KLD Loss: 57.7216, Recon Loss: -0.2404
model saved
epoch8start
A young men standing in a a a a      
A young man walking in a a a a      
A young men standing in a a a       
A workers lift lifting a crane in a       
pair image latent
0.8959511518478394
same image and text latent
0.1917761266231537
pair text latent
0.8548980951309204
unpair image latent
0.5413997173309326
different image and text latent
0.12088106572628021
unpair text latent
0.5156203508377075
eval_start
recon
-0.23716039794683458
simsiam
-0.23441784135997296
message entropy
4.598154631551107
image_collapse
0.3571342925301748
text_collapse
0.3637368446683046
 Avg Loss: -0.2134, SimSiam Loss: 0.0000, KLD Loss: 57.8494, Recon Loss: -0.2423
model saved
epoch9start
A young men standing in a a a a      
A young man attempting a a a a a      
A young men standing in a a a a      
A workers lift working on a crane working       
pair image latent
0.8959511518478394
same image and text latent
0.1917761266231537
pair text latent
0.8965190649032593
unpair image latent
0.5413997173309326
different image and text latent
0.10639648139476776
unpair text latent
0.5289806127548218
eval_start
recon
-0.2410194875150919
simsiam
-0.23676292923092843
message entropy
4.598167903645833
image_collapse
0.35503416795927045
text_collapse
0.35420026080815925
 Avg Loss: -0.2134, SimSiam Loss: 0.0000, KLD Loss: 57.6004, Recon Loss: -0.2422
model saved
epoch10start
A young men standing in a a a a      
A young man walking in a a a a      
A young men standing in a a a a      
A crane working on a lift in a       
pair image latent
0.8959511518478394
same image and text latent
0.1917761266231537
pair text latent
0.8532997369766235
unpair image latent
0.5413997173309326
different image and text latent
0.07093457132577896
unpair text latent
0.468993604183197
eval_start
recon
-0.23830882178246976
simsiam
-0.23444557583332062
message entropy
4.598118258666992
image_collapse
0.35782046571245407
text_collapse
0.36351095932672217
 Avg Loss: -0.2154, SimSiam Loss: 0.0000, KLD Loss: 57.5506, Recon Loss: -0.2442
model saved
epoch11start
A men standing in a a a a a      
A young man walking in a a a a      
A young men standing in a a a a      
A workers lift working on a crane in a      
pair image latent
0.8959511518478394
same image and text latent
0.18589867651462555
pair text latent
0.8532997369766235
unpair image latent
0.5413997173309326
different image and text latent
0.10142600536346436
unpair text latent
0.5401153564453125
eval_start
recon
-0.2412437891960144
simsiam
-0.2367862928211689
message entropy
4.598259259033203
image_collapse
0.35446847384172
text_collapse
0.34528290011017615
 Avg Loss: -0.2150, SimSiam Loss: 0.0000, KLD Loss: 57.2810, Recon Loss: -0.2437
model saved
epoch12start
A men standing in a a a a a      
A man attempting a a a a a a      
A men standing in a a a a       
A crane working on a lift in a       
pair image latent
0.8959511518478394
same image and text latent
0.18589867651462555
pair text latent
0.8578856587409973
unpair image latent
0.5413997173309326
different image and text latent
0.07093457132577896
unpair text latent
0.49450331926345825
eval_start
recon
-0.24253001235425473
simsiam
-0.23757494281232358
message entropy
4.598242727661133
image_collapse
0.3577795317371628
text_collapse
0.3435016785649335
 Avg Loss: -0.2160, SimSiam Loss: 0.0000, KLD Loss: 57.0700, Recon Loss: -0.2445
model saved
epoch13start
A men standing in a a a a a      
A man and a approaching a a a a      
Two men standing in a a a a       
A crane working on a lift lifting a a      
pair image latent
0.8959511518478394
same image and text latent
0.18589867651462555
pair text latent
0.7946306467056274
unpair image latent
0.5413997173309326
different image and text latent
0.0784359723329544
unpair text latent
0.47788724303245544
eval_start
recon
-0.246097589045763
simsiam
-0.24144960503280163
message entropy
4.598393175252279
image_collapse
0.35516393846857985
text_collapse
0.32856893340717974
 Avg Loss: -0.2174, SimSiam Loss: 0.0000, KLD Loss: 57.1642, Recon Loss: -0.2459
model saved
epoch14start
A men standing in a a a a a      
A persons attempting a a a a a a      
Two men attempting a a a a a a      
A workers lift scaff scaff working under a a      
pair image latent
0.8959511518478394
same image and text latent
0.18589867651462555
pair text latent
0.8626362085342407
unpair image latent
0.5413997173309326
different image and text latent
0.10295506566762924
unpair text latent
0.5204678773880005
eval_start
recon
-0.24435937777161598
simsiam
-0.2419399397969246
message entropy
4.598227552286784
image_collapse
0.35833572793358637
text_collapse
0.3320787765975114
 Avg Loss: -0.2169, SimSiam Loss: 0.0000, KLD Loss: 57.3025, Recon Loss: -0.2455
model saved
epoch15start
A men standing in a green a a a      
A man and a attempting a a a a      
Two men standing in a a a a a      
A group of workers working on a crane lift      
pair image latent
0.8959511518478394
same image and text latent
0.19659927487373352
pair text latent
0.8395439386367798
unpair image latent
0.5413997173309326
different image and text latent
0.09377340227365494
unpair text latent
0.3729168176651001
eval_start
recon
-0.2470706311315298
simsiam
-0.2422240263968706
message entropy
4.5983619750976565
image_collapse
0.35621485246978535
text_collapse
0.32784105196256075
 Avg Loss: -0.2177, SimSiam Loss: 0.0000, KLD Loss: 57.4814, Recon Loss: -0.2465
model saved
epoch16start
A men standing in a a a a a      
A person attempting a walking in a a a      
Two men attempting a a a a a a      
A group of workers working on a crane lift      
pair image latent
0.8959511518478394
same image and text latent
0.18589867651462555
pair text latent
0.7073867321014404
unpair image latent
0.5413997173309326
different image and text latent
0.09377340227365494
unpair text latent
0.5101578235626221
eval_start
recon
-0.24027218826115132
simsiam
-0.23477191293239594
message entropy
4.598108279418946
image_collapse
0.35746852643939464
text_collapse
0.35364566480496895
 Avg Loss: -0.2167, SimSiam Loss: 0.0000, KLD Loss: 57.3129, Recon Loss: -0.2453
model saved
epoch17start
A men standing in a a a a a      
A persons attempting a a a a a a      
A men attempting a a a a a a      
A workers working on a crane lift lift working      
pair image latent
0.8959511518478394
same image and text latent
0.18589867651462555
pair text latent
0.931017279624939
unpair image latent
0.5413997173309326
different image and text latent
0.08989374339580536
unpair text latent
0.519048273563385
eval_start
recon
-0.24687645541876554
simsiam
-0.24216728554666042
message entropy
4.59837009379069
image_collapse
0.3583816689651239
text_collapse
0.3284018938812747
 Avg Loss: -0.2169, SimSiam Loss: 0.0000, KLD Loss: 57.4698, Recon Loss: -0.2456
model saved
epoch18start
A men standing in a a a a a      
A young attempting walking in a a a a      
Two men attempting a gardening a a a       
A men working on a crane lift working       
pair image latent
0.8959511518478394
same image and text latent
0.18589867651462555
pair text latent
0.5435213446617126
unpair image latent
0.5413997173309326
different image and text latent
0.10009326040744781
unpair text latent
0.5748819708824158
eval_start
recon
-0.24195813500881194
simsiam
-0.23730967622995378
message entropy
4.598123075358073
image_collapse
0.35804568000526116
text_collapse
0.3488118940001712
 Avg Loss: -0.2178, SimSiam Loss: 0.0000, KLD Loss: 57.3856, Recon Loss: -0.2465
model saved
epoch19start
A men standing in a a a a a      
A person attempting a a a a a a      
Two men standing in a a a a a      
A men working on a crane lift working       
pair image latent
0.8959511518478394
same image and text latent
0.18589867651462555
pair text latent
0.7571634650230408
unpair image latent
0.5413997173309326
different image and text latent
0.10009326040744781
unpair text latent
0.5748819708824158
eval_start
recon
-0.25022737773507836
simsiam
-0.24288832761347293
message entropy
4.598279015096028
image_collapse
0.357802450633795
text_collapse
0.31351668994829185
 Avg Loss: -0.2176, SimSiam Loss: 0.0000, KLD Loss: 57.2598, Recon Loss: -0.2462
model saved
Two men standing in a green grass a       
A young attempting and a a a a a      
Two men standing in a a a a a      
A men working on a crane lift working       
pair image latent
0.8959511518478394
same image and text latent
0.24510757625102997
pair text latent
0.7483975291252136
unpair image latent
0.5413997173309326
different image and text latent
0.10009326040744781
unpair text latent
0.3612642288208008
val_data recon loss history
[-0.24015939712524415, -0.24325326254963875, -0.24398726338148116, -0.23878244202584029, -0.23973042146861553, -0.24248588575422764, -0.2390925730764866, -0.23692487651109695, -0.23716039794683458, -0.2410194875150919, -0.23830882178246976, -0.2412437891960144, -0.24253001235425473, -0.246097589045763, -0.24435937777161598, -0.2470706311315298, -0.24027218826115132, -0.24687645541876554, -0.24195813500881194, -0.25022737773507836]
val_data simsiam loss history
[-0.23574363582581281, -0.23753241215646267, -0.2379425897449255, -0.2357692233324051, -0.23669353222846984, -0.2391774744093418, -0.23575860176980495, -0.23402344699203967, -0.23441784135997296, -0.23676292923092843, -0.23444557583332062, -0.2367862928211689, -0.23757494281232358, -0.24144960503280163, -0.2419399397969246, -0.2422240263968706, -0.23477191293239594, -0.24216728554666042, -0.23730967622995378, -0.24288832761347293]
val entorpy history
[4.598785892740885, 4.59864211730957, 4.598570929972331, 4.598446892293294, 4.598304741414388, 4.598399342854818, 4.598192714436849, 4.59809855855306, 4.598154631551107, 4.598167903645833, 4.598118258666992, 4.598259259033203, 4.598242727661133, 4.598393175252279, 4.598227552286784, 4.5983619750976565, 4.598108279418946, 4.59837009379069, 4.598123075358073, 4.598279015096028]
image collapse level history
[0.3529878821477972, 0.3560924118778672, 0.35502787042461026, 0.35708664806713086, 0.35541336213643315, 0.3574204690232581, 0.35561529619865206, 0.3575550401122676, 0.3571342925301748, 0.35503416795927045, 0.35782046571245407, 0.35446847384172, 0.3577795317371628, 0.35516393846857985, 0.35833572793358637, 0.35621485246978535, 0.35746852643939464, 0.3583816689651239, 0.35804568000526116, 0.357802450633795]
text collapse level history
[0.33804723926214986, 0.3278129711522727, 0.3307649663338108, 0.3474040852887966, 0.34880714503960775, 0.3372102865819817, 0.3519312384224337, 0.3647720148328595, 0.3637368446683046, 0.35420026080815925, 0.36351095932672217, 0.34528290011017615, 0.3435016785649335, 0.32856893340717974, 0.3320787765975114, 0.32784105196256075, 0.35364566480496895, 0.3284018938812747, 0.3488118940001712, 0.31351668994829185]
total loss history
[tensor(-0.1934, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2086, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2120, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2115, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2116, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2136, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2125, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2115, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2134, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2134, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2154, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2150, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2160, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2174, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2169, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2177, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2167, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2169, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2178, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2176, device='cuda:3', grad_fn=<DivBackward0>)]
simsiam loss history
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
kld loss history
[tensor(80.2639, device='cuda:3', grad_fn=<DivBackward0>), tensor(60.3015, device='cuda:3', grad_fn=<DivBackward0>), tensor(59.2564, device='cuda:3', grad_fn=<DivBackward0>), tensor(58.3221, device='cuda:3', grad_fn=<DivBackward0>), tensor(57.8880, device='cuda:3', grad_fn=<DivBackward0>), tensor(58.1826, device='cuda:3', grad_fn=<DivBackward0>), tensor(58.1421, device='cuda:3', grad_fn=<DivBackward0>), tensor(57.7216, device='cuda:3', grad_fn=<DivBackward0>), tensor(57.8494, device='cuda:3', grad_fn=<DivBackward0>), tensor(57.6004, device='cuda:3', grad_fn=<DivBackward0>), tensor(57.5506, device='cuda:3', grad_fn=<DivBackward0>), tensor(57.2810, device='cuda:3', grad_fn=<DivBackward0>), tensor(57.0700, device='cuda:3', grad_fn=<DivBackward0>), tensor(57.1642, device='cuda:3', grad_fn=<DivBackward0>), tensor(57.3025, device='cuda:3', grad_fn=<DivBackward0>), tensor(57.4814, device='cuda:3', grad_fn=<DivBackward0>), tensor(57.3129, device='cuda:3', grad_fn=<DivBackward0>), tensor(57.4698, device='cuda:3', grad_fn=<DivBackward0>), tensor(57.3856, device='cuda:3', grad_fn=<DivBackward0>), tensor(57.2598, device='cuda:3', grad_fn=<DivBackward0>)]
recon loss history 
[tensor(-0.2335, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2387, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2417, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2407, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2406, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2427, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2416, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2404, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2423, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2422, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2442, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2437, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2445, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2459, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2455, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2465, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2453, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2456, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2465, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2462, device='cuda:3', grad_fn=<DivBackward0>)]
training finish!!!
