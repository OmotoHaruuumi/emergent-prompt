args:Namespace(text_enc_freeze=True, image_enc_freeze=True, use_simsiam=False, use_recon_loss=True, use_proj=False, clip_vision_adapter_late=0.2, kld_loss_beta=0.0005, word_length=15, dictionary_size=50257, latent_dim=768, hidden_dim=2048, epochs=10, batch_size=8, dataset_size=5000, save_every=1, learning_rate=5e-06, gpt_path='/root/emergent-prompt/train-model/pretrained-model/trained_gpt.pt', clip_to_gpt_path='/root/emergent-prompt/train-model/pretrained-model/trained_mlp.pt', translator_path='/root/emergent-prompt/train-model/pretrained-model/trained_translator_linear9.pt', device='cuda', debug=False, prefix='trained-model', out_dir='/root/emergent-prompt/save-output/LLMPrior', out_txt='/root/emergent-prompt/save-txt', setting_name='LLMPrior', run_path='experiments/2025-04-16T08:59:21.603954x88geb6r/')
[{'params': <generator object Module.parameters at 0x7f9a697d6e30>, 'lr': 5e-06}]
dataset length is 5000
epoch0start
Two men in a green yard playing with a frisbee.  
Two men are standing in a garden with a door.    
Two men in a garden with a yellow frisbee.   
A crane is lifting a person up into the air.    
pair image latent
0.8465549349784851
same image and text latent
0.253468781709671
pair text latent
0.6683161854743958
unpair image latent
0.5413997173309326
different image and text latent
0.14986775815486908
unpair text latent
0.3701286315917969
eval_start
recon
-0.24513007793575525
simsiam
-0.23792731465399267
message entropy
4.600489984130859
image_collapse
0.36259642308430573
text_collapse
0.2494365389664952
 Avg Loss: -0.0512, SimSiam Loss: 0.0000, KLD Loss: 351.9936, Recon Loss: -0.2272
model saved
epoch1start
Two men are playing with a frisbee in a garden.  
Two men are standing in a garden with a door.    
Two men in a garden with a yellow frisbee.   
A crane is lifting a person up into the air.    
pair image latent
0.8465549349784851
same image and text latent
0.2659342885017395
pair text latent
0.6683161854743958
unpair image latent
0.5413997173309326
different image and text latent
0.14986775815486908
unpair text latent
0.4760412573814392
eval_start
recon
-0.24877262217551468
simsiam
-0.24061914823204278
message entropy
4.601751856486002
image_collapse
0.3619084432322469
text_collapse
0.24991453217103188
 Avg Loss: -0.0528, SimSiam Loss: 0.0000, KLD Loss: 350.4785, Recon Loss: -0.2280
model saved
epoch2start
Two men are playing with a frisbee in a garden.  
Two men are standing in a garden with a door.    One
Two men are playing with a frisbee in a garden.  
A crane is lifting a crane with two men working on it.  
pair image latent
0.8465549349784851
same image and text latent
0.2659342885017395
pair text latent
0.7192866206169128
unpair image latent
0.5413997173309326
different image and text latent
0.1334237903356552
unpair text latent
0.4968329966068268
eval_start
recon
-0.2548106829226017
simsiam
-0.2439149990081787
message entropy
4.602634416707357
image_collapse
0.36111417957801306
text_collapse
0.24725924378643516
 Avg Loss: -0.0740, SimSiam Loss: 0.0000, KLD Loss: 308.0725, Recon Loss: -0.2280
model saved
epoch3start
Two young men are playing with a frisbee in their garden. 
Two men are standing in a garden with their hands in the air. 
Two young men are playing with their skateboards outside.  One is holding
A crane operator is working on a crane.  One crane is lifting another
pair image latent
0.8465549349784851
same image and text latent
0.27359193563461304
pair text latent
0.5165218114852905
unpair image latent
0.5413997173309326
different image and text latent
0.10997666418552399
unpair text latent
0.44755393266677856
eval_start
recon
-0.2577674945741892
simsiam
-0.24685466502606868
message entropy
4.603274217732747
image_collapse
0.36112192244849695
text_collapse
0.24235620010037506
 Avg Loss: -0.0913, SimSiam Loss: 0.0000, KLD Loss: 269.4111, Recon Loss: -0.2260
model saved
epoch4start
Two young men are playing with their skateboards in the garden.  One
Two men are standing in a garden opening their wallets.  One is holding
Two young men are playing with their skateboards outside.  One is holding
A crane operator is working on his crane while another crane operator watches. 
pair image latent
0.8465549349784851
same image and text latent
0.26602038741111755
pair text latent
0.6689139604568481
unpair image latent
0.5413997173309326
different image and text latent
0.11896850168704987
unpair text latent
0.5065975189208984
eval_start
recon
-0.26204006615281106
simsiam
-0.2505128730982542
message entropy
4.603682502237956
image_collapse
0.35997484199588203
text_collapse
0.2355559466692243
 Avg Loss: -0.1009, SimSiam Loss: 0.0000, KLD Loss: 249.5462, Recon Loss: -0.2257
model saved
epoch5start
Two young men are playing with their skateboards in the garden.  One
Two men are attempting to enter a garden together.  One is holding a
Two young men are playing with their skateboards outside.  One is holding
A crane operator working on crane lift lift lift lift lift lift lift. 
pair image latent
0.8465549349784851
same image and text latent
0.26602038741111755
pair text latent
0.7075611352920532
unpair image latent
0.5413997173309326
different image and text latent
0.0616547130048275
unpair text latent
0.35822415351867676
eval_start
recon
-0.2648920599222183
simsiam
-0.2523078402131796
message entropy
4.6038152170817055
image_collapse
0.36341979993155893
text_collapse
0.23758607569095458
 Avg Loss: -0.1069, SimSiam Loss: 0.0000, KLD Loss: 241.0993, Recon Loss: -0.2274
model saved
epoch6start
Two young men are playing frisbee in their backyard garden.  One
Two men are attempting to enter a garden through a door.  One is
Two young men are playing with their skateboards outside.  One is holding
A crane operator working on crane lift lift lift lift lift lift lift lift lift
pair image latent
0.8465549349784851
same image and text latent
0.2638719379901886
pair text latent
0.6824645400047302
unpair image latent
0.5413997173309326
different image and text latent
0.0625782459974289
unpair text latent
0.3121184706687927
eval_start
recon
-0.26569999688863755
simsiam
-0.25278895503282545
message entropy
4.603865674845378
image_collapse
0.3597621711532588
text_collapse
0.23789434517448516
 Avg Loss: -0.1107, SimSiam Loss: 0.0000, KLD Loss: 239.6732, Recon Loss: -0.2305
model saved
epoch7start
Two young men are playing frisbee in their backyard garden.  One
Two men are attempting to enter a garden through a door.  One is
Two young men are playing with their skateboards outside.  One is holding
A crane operator working on crane lift lift lift lift lift lift lift lift lift
pair image latent
0.8465549349784851
same image and text latent
0.2638719379901886
pair text latent
0.6824645400047302
unpair image latent
0.5413997173309326
different image and text latent
0.0625782459974289
unpair text latent
0.3121184706687927
eval_start
recon
-0.2656751303523779
simsiam
-0.25383646284043787
message entropy
4.603930744425456
image_collapse
0.35993199811253807
text_collapse
0.2429482715967073
 Avg Loss: -0.1129, SimSiam Loss: 0.0000, KLD Loss: 237.3745, Recon Loss: -0.2316
model saved
epoch8start
Two young men are playing frisbee in their backyard garden.  One
Two men are attempting to enter a garden through a door.  One is
Two young men are playing with their skateboards outside.  One is holding
A crane operator performing maintenance on crane equipment during emergency.  Recovery time unknown
pair image latent
0.8465549349784851
same image and text latent
0.2638719379901886
pair text latent
0.6824645400047302
unpair image latent
0.5413997173309326
different image and text latent
0.07563668489456177
unpair text latent
0.34329891204833984
eval_start
recon
-0.26852158138155935
simsiam
-0.25527663543820384
message entropy
4.604032456461589
image_collapse
0.36188010432627604
text_collapse
0.24547430566336026
 Avg Loss: -0.1143, SimSiam Loss: 0.0000, KLD Loss: 239.4158, Recon Loss: -0.2340
model saved
epoch9start
Two young men are playing frisbee in their backyard garden.  One
Two men are attempting to enter a garden through a door.  One is
Two young men are playing with their skateboards outside in the garden. 
A crane operator performing maintenance on crane lift lift lift lift lift lift lift lift
pair image latent
0.8465549349784851
same image and text latent
0.2638719379901886
pair text latent
0.7227334976196289
unpair image latent
0.5413997173309326
different image and text latent
0.05628206580877304
unpair text latent
0.2599181532859802
eval_start
recon
-0.2667654240429401
simsiam
-0.2550704115927219
message entropy
4.603994714355469
image_collapse
0.361357202472933
text_collapse
0.2476724033554536
 Avg Loss: -0.1158, SimSiam Loss: 0.0000, KLD Loss: 240.3446, Recon Loss: -0.2359
model saved
Two young men are playing frisbee in their backyard garden area. 
Two men are attempting to enter a garden through a door.  One is
Two young men are playing with their skateboards outside their home.  One
A crane operator performing repairs on crane lift lift lift lift lift lift lift lift
pair image latent
0.8465549349784851
same image and text latent
0.2624911665916443
pair text latent
0.6933251619338989
unpair image latent
0.5413997173309326
different image and text latent
0.0595979243516922
unpair text latent
0.27435600757598877
val_data recon loss history
[-0.24513007793575525, -0.24877262217551468, -0.2548106829226017, -0.2577674945741892, -0.26204006615281106, -0.2648920599222183, -0.26569999688863755, -0.2656751303523779, -0.26852158138155935, -0.2667654240429401]
val_data simsiam loss history
[-0.23792731465399267, -0.24061914823204278, -0.2439149990081787, -0.24685466502606868, -0.2505128730982542, -0.2523078402131796, -0.25278895503282545, -0.25383646284043787, -0.25527663543820384, -0.2550704115927219]
val entorpy history
[4.600489984130859, 4.601751856486002, 4.602634416707357, 4.603274217732747, 4.603682502237956, 4.6038152170817055, 4.603865674845378, 4.603930744425456, 4.604032456461589, 4.603994714355469]
image collapse level history
[0.36259642308430573, 0.3619084432322469, 0.36111417957801306, 0.36112192244849695, 0.35997484199588203, 0.36341979993155893, 0.3597621711532588, 0.35993199811253807, 0.36188010432627604, 0.361357202472933]
text collapse level history
[0.2494365389664952, 0.24991453217103188, 0.24725924378643516, 0.24235620010037506, 0.2355559466692243, 0.23758607569095458, 0.23789434517448516, 0.2429482715967073, 0.24547430566336026, 0.2476724033554536]
total loss history
[tensor(-0.0512, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.0528, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.0740, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.0913, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.1009, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.1069, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.1107, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.1129, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.1143, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.1158, device='cuda:3', grad_fn=<DivBackward0>)]
simsiam loss history
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
kld loss history
[tensor(351.9936, device='cuda:3', grad_fn=<DivBackward0>), tensor(350.4785, device='cuda:3', grad_fn=<DivBackward0>), tensor(308.0725, device='cuda:3', grad_fn=<DivBackward0>), tensor(269.4111, device='cuda:3', grad_fn=<DivBackward0>), tensor(249.5462, device='cuda:3', grad_fn=<DivBackward0>), tensor(241.0993, device='cuda:3', grad_fn=<DivBackward0>), tensor(239.6732, device='cuda:3', grad_fn=<DivBackward0>), tensor(237.3745, device='cuda:3', grad_fn=<DivBackward0>), tensor(239.4158, device='cuda:3', grad_fn=<DivBackward0>), tensor(240.3446, device='cuda:3', grad_fn=<DivBackward0>)]
recon loss history 
[tensor(-0.2272, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2280, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2280, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2260, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2257, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2274, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2305, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2316, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2340, device='cuda:3', grad_fn=<DivBackward0>), tensor(-0.2359, device='cuda:3', grad_fn=<DivBackward0>)]
training finish!!!
